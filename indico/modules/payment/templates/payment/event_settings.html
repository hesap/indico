{% extends 'admin/base.html' %}

{% block title %}{% trans %}Payment settings{% endtrans %}{% endblock %}

{% block content %}
    {% if settings.enabled and not enabled_plugins %}
        <div class="warning-message-box fixed-width">
            <div class="message-text">
                {% trans -%}
                    The payment module is enabled but you did not enable any payment methods. You must enable at least
                    one method for the module to work properly.
                {%- endtrans %}
            </div>
        </div>
    {% endif %}

    <dl class="i-data-list">
        <dt>{% trans %}Status{% endtrans %}</dt>
        <dd>
            <form action="{{ url_for('.event_toggle', event) }}" method="post">
                <label class="switch">
                    <input type="checkbox" class="switch-input" id="toggle-payment"{% if settings.enabled %} checked{% endif %}>
                    <span class="switch-label" data-on="On" data-off="Off"></span>
                    <span class="switch-handle"></span>
                </label>
                <input type="hidden" name="enabled" value="{{ (not settings.enabled) | int }}">
            </form>
        </dd>
        {% if settings.enabled %}
            <dt>{% trans %}Currency{% endtrans %}</dt>
            <dd>
                {% if not settings.currency %}
                    {% trans %}None selected{% endtrans %}
                {% else %}
                    {{ settings.currency }}{% if settings.currency in currencies %} {{ currencies[settings.currency] }}{% endif %}
                {% endif %}
            </dd>
            <dt>{% trans %}Conditions{% endtrans %}</dt>
            <dd>{{ settings.conditions or 'None' }}</dd>
            <dt>{% trans %}Summary email message{% endtrans %}</dt>
            <dd>{{ settings.summary_email or 'None' }}</dd>
            <dt>{% trans %}Success email message{% endtrans %}</dt>
            <dd>{{ settings.success_email or 'None' }}</dd>
            <dt></dt>
            <dd><a class="i-button big" href="{{ url_for('.event_settings_edit', event) }}">{% trans %}Configure{% endtrans %}</a></dd>
        {% endif %}
    </dl>

    {% if settings.enabled %}
        <p class="fixed-width">
            {% trans -%}
                The following payment methods are available. You can enable, disable and configure them by clicking on the title.
            {%- endtrans %}
        </p>
        <ul>
            {% for short_name, plugin in plugins %}
                <li>
                    <a href="{{ url_for('.event_plugin_edit', event, method=short_name) }}">{{ plugin.title }}</a>
                    {% if plugin in enabled_plugins %}
                        ({% trans %}enabled{% endtrans %})
                    {% else %}
                        ({% trans %}disabled{% endtrans %})
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    <script>
        $('#toggle-payment').on('change', function() {
            this.form.submit();
        });
    </script>
{% endblock %}
